<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Mis cursos</title>
    </h:head>
    <h:body>
        <h:form>
            <p:toolbar style="height: 60px ">
                <f:facet name="left">
                    <img src="img/minerva.png" height="55px" width="40px" onclick="location.href = 'principal.jsf'"/>
                </f:facet>
                <f:facet name="right">
                    <p:commandButton value="∷" rendered="#{manejadorLogin.loginadmin()}" oncomplete="PF('sidebar2').show()" style="height: 55px; font-size: 24" />
                </f:facet>
            </p:toolbar>



            <p:sidebar widgetVar="sidebar2" position="right" baseZIndex="10000">
                <h1 style="font-weight:normal">Administración de Cursos</h1>
                <!--   <p:commandButton value="Cancel" oncomplete="PF('sidebar2').hide()"/>-->
                <center>
                    <img src="img/minerva.png" width="100px" height="120px" onclick="location.href = 'principal.jsf'"/>
                </center>
                <br/><br/>
                <p:commandButton value="Nuevo Curso" styleClass="boton_personalizado" onclick="location.href = 'creacion.jsf'"/>
                <p:separator/>
                <p:commandButton value="Mis cursos" class="boton_personalizado" onclick="location.href = 'miscursos.jsf'"/>
                <p:separator/>
                <p:commandButton value="Estadisticas" class="boton_personalizado"/>
                <p:separator/>
                    <p:commandButton value="Cerrar Sesión" class="boton_personalizado" action="#{manejadorLogin.cerrarsesion()}"/>
            </p:sidebar>
        </h:form>

        <h:form id="form">
            <p:growl id="mensaje" severity="info, fatal" showSummary="true" showDetail="true"/>
            <p:growl id="msgs" showDetail="true"/>    
            <p:dataTable var="cursoActivos" value="#{manejadorCursos.listaCursos}" paginator="true" rows="10"
                         paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                         rowsPerPageTemplate="5,10,15" selectionMode="single" selection="#{manejadorCursos.curso}" id="idCursoSelected" lazy="true" rowKey="#{cursoActivos.idCurso}">
                <p:ajax event="rowSelect" listener="#{manejadorCursos.onRowSelect}" update=":form:carDetail" />
                <f:facet name="header">
                    Cursos UESFMOcc
                </f:facet>
                <p:column headerText="Id" >
                    <h:outputText value="#{cursoActivos.idCurso}" />
                </p:column>
                <p:column headerText="Nombre" >
                    <h:outputText value="#{cursoActivos.nombreCurso}" />
                </p:column>
                <p:column headerText="descripcion" >
                    <h:outputText value="#{cursoActivos.descripcion}" />
                </p:column>

            </p:dataTable>
            <p:contextMenu for="idCursoSelected">
                <p:menuitem id="modificar" value="Modificar" update="carDetail" oncomplete="PF('carCursos').show()"/>
                <p:menuitem id="archivar" value="Archivar" update="carArchivar" oncomplete="PF('carArchivar').show()"/>
            </p:contextMenu>

            <p:dialog header="Detalle curso seleccionado" widgetVar="carCursos" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="carDetail" style="text-align:center; border: none">
                    <p:panelGrid id="panel" columns="3" layout="grid"  style="width: 775px; height: 300px"> 
                        <p:outputLabel for="nombreCurso"  value="Nombre" />
                        <p:inputText id="nombreCurso" value="#{manejadorCursos.curso.nombreCurso}"  required="true" requiredMessage="Nombre requeridp"/>
                        <p:message for="nombreCurso" />

                        <p:outputLabel for="descripcionCurso" value="Descripcion" />
                        <p:inputTextarea id="descripcionCurso" value="#{manejadorCursos.curso.descripcion}" required="true" requiredMessage="Descripcion requerida"/>
                        <p:message for="descripcionCurso" />


                        <p:outputLabel for="fechaInicio" value="Fecha inicio" />
                        <p:calendar id="fechaInicio" value="#{manejadorCursos.curso.fechaInicio}" required="true" requiredMessage="Fecha inicio requerida" mask="99/99/99"/>
                        <p:message for="fechaInicio" />


                        <p:outputLabel for="fechaFin" value="Fecha fin" />
                        <p:calendar id="fechaFin" value="#{manejadorCursos.curso.fechaFin}" required="true" requiredMessage="Fecha fin requerida" mask="99/99/99" />
                        <p:message for="fechaFin" />


                        <p:outputLabel for="cupo" value="Capacidad" />
                        <p:inputText id="cupo" value="#{manejadorCursos.curso.cupo}" required="true" requiredMessage="Cupo requerido" onkeypress="if(event.which &lt; 48 || event.which &gt; 57) return false;" maxlength="3"/>
                        <p:message for="cupo" />

                        <p:outputLabel />
                        <p:commandButton value="Editar" action="#{manejadorCursos.editarcurso()}" update="mensaje, panel, form, idCursoSelected" />
                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
            <p:dialog header="Car Detail" widgetVar="carArchivar" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="carArchivar" style="text-align:center; border: none">
                    <p:panelGrid  columns="2" rendered="#{not empty manejadorCursos.curso}" columnClasses="label,value">
                        <f:facet name="header">
                            <p:outputLabel value="¿Desea archivar Curso #{manejadorCursos.curso.nombreCurso} ?" />
                        </f:facet>
                        <p:commandButton id="archivarSI" value="SI" action="#{manejadorCursos.archivarCurso()}" update="mensaje, panel,form,idCursoSelected"/>
                        <p:commandButton id="archivarNO" value="NO" oncomplete="PF('carArchivar').hide()" />
                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <f:metadata>
            <f:viewAction action="#{manejadorLogin.loginPrincipal()}" />
        </f:metadata>
    </h:body>
</html>

