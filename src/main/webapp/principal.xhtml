<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Principal</title>
    </h:head>
    <h:body>
        <p:toolbar style="height: 60px ">
            <f:facet name="left">
                <img src="img/minerva.png" height="55px" width="40px" onclick="location.href = 'principal.jsf'"/>
            </f:facet>
            <f:facet name="right">
                <p:commandButton value="∷" rendered="#{manejadorLogin.loginadmin()}" oncomplete="PF('sidebar2').show()" style="height: 55px; font-size: 24" />
            </f:facet>
        </p:toolbar>



        <p:sidebar widgetVar="sidebar2" position="right" baseZIndex="10000">
            <h1 style="font-weight:normal">Administración de Cursos</h1>
            <!--   <p:commandButton value="Cancel" oncomplete="PF('sidebar2').hide()"/>-->
            <center>
                <img src="img/minerva.png" width="100px" height="120px" onclick="location.href = 'principal.jsf'"/>
            </center>
            <br/><br/>
            <p:commandButton value="Nuevo Curso" styleClass="boton_personalizado" onclick="location.href = 'creacion.jsf'"/>
            <p:separator/>
            <p:commandButton value="Mis cursos" class="boton_personalizado" onclick="location.href = 'miscursos.jsf'"/>
            <p:separator/>
            <p:commandButton value="Estadisticas" class="boton_personalizado"/>
            <p:separator/>
            <h:form>
                <p:commandButton value="Cerrar Sesión" class="boton_personalizado" action="#{manejadorLogin.cerrarsesion()}"/>
            </h:form>   
        </p:sidebar>


        <p:dialog header="¿Desea cerrar sesión?" widgetVar="dlg3" showEffect="explode" hideEffect="bounce" height="100">
            <center>
                <h:form>
                    <p:commandButton value="SI" action="#{manejadorLogin.cerrarsesion()}"/>
                </h:form>
                <p:commandButton value="NO" onclick="PF('dlg3').hide();$('#form').trigger('reset');" type="button"/>
            </center>
        </p:dialog>
        <style type="text/css">
            .value {
                font-weight: bold;
            }
        </style>
        <h:form id="cursosActivos">
            <p:dataGrid var="cursos" value="#{manejadorCursos.listaCursos}" columns="3" layout="grid"
                        rows="12" paginator="true" id="idcursos"
                        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        rowsPerPageTemplate="6,12,16">
                <f:facet name="header">
                    Cursos Decanato UESFMOcc
                </f:facet>

                <p:panel header="#{cursos.nombreCurso}" style="text-align:center">
                    <h:panelGrid columns="1" style="width:100%">

                        <h:outputText value="#{cursos.descripcion}" />
                        <h:outputText value="#{cursos.cupo}" />


                        <p:commandLink update=":cursosActivos:carDetail" oncomplete="PF('carDialog').show()" title="View Detail">
                            <h:outputText value="VER" style="margin:0 auto;"/>
                            <f:setPropertyActionListener value="#{cursos}" target="#{manejadorCursos.curso}" />
                        </p:commandLink>
                        <p:commandLink update=":frmAdd:panelInscripcion" oncomplete="PF('inscripcionDialog').show()" title="View Detail">
                            <h:outputText value="INSCRIBIR" style="margin:0 auto;"/>
                            <f:setPropertyActionListener value="#{cursos}" target="#{manejadorCursos.curso}" />
                        </p:commandLink>
                    </h:panelGrid>
                </p:panel>

            </p:dataGrid>
            <p:dialog header="Info Cursos" widgetVar="carDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="carDetail" style="text-align:center;">
                    <p:panelGrid  columns="2" rendered="#{not empty manejadorCursos.curso}" columnClasses="label,value">

                        <h:outputText value="Nombre:" />
                        <h:outputText value="#{manejadorCursos.curso.nombreCurso}" />

                        <h:outputText value="Descripción:" />
                        <h:outputText value="#{manejadorCursos.curso.descripcion}" />

                        <h:outputText value="Cupo:" />
                        <h:outputText value="#{manejadorCursos.curso.cupo}" />

                        <h:outputText value="Inicia" />
                        <h:outputText value="#{manejadorCursos.curso.fechaInicio.day+21}/#{manejadorCursos.curso.fechaInicio.month+1}/#{manejadorCursos.curso.fechaInicio.year+1900}" />

                        <h:outputText value="Finaliza" />
                        <h:outputText value="#{manejadorCursos.curso.fechaFin.day+21}/#{manejadorCursos.curso.fechaFin.month+1}/#{manejadorCursos.curso.fechaFin.year+1900}"/>
                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>
        <h:form id="frmAdd">
            <p:growl id="mensaje" severity="info, fatal" showSummary="true" showDetail="true"/>
            <p:dialog header="Inscribirse" widgetVar="inscripcionDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                <p:outputPanel id="panelInscripcion" style="text-align:center; border: none">
                    <p:panelGrid  id="panel" columns="1" rendered="#{not empty manejadorCursos.curso}" columnClasses="label,value" style="border: none">


                        <p:inputText id="nombre" class="input1" type="text" value="#{manejadorCursos.estudiante.nombreEstudiante}" 
                                     placeholder="Nombre" required="true" requiredMessage="Nombre requerido" size="30" maxlength="25" 
                                     validatorMessage="Ingrese solo letras">
                            <f:validateRegex pattern="^[a-zA-Z\s]*$" />
                        </p:inputText>
                        <p:message for="nombre" />

                        <p:inputText id="apellido" class="input1" value="#{manejadorCursos.estudiante.apellidoEstudiante}" 
                                     placeholder="Apellido" required="true" requiredMessage="Apellido requerido" size="30" maxlength="25"
                                     validatorMessage="Ingrese solo letras">
                            <f:validateRegex pattern="^[a-zA-Z\s]*$" />
                        </p:inputText>
                        <p:message for="apellido" />

                        <p:inputMask id="carnet" class="input1" type="text" value="#{manejadorCursos.estudiante.carnet}" 
                                     placeholder="Carnet" required="true" requiredMessage="Carnet requerido" mask="aa99999"></p:inputMask>
                        <p:message for="carnet" />

                        <p:inputText id="email" class="input1" type="text" value="#{manejadorCursos.estudiante.correoEstudiante}" 
                                     placeholder="Correo" required="true"
                                     requiredMessage="Email Requerido"
                                     validatorMessage="Formato de email incorecto"
                                     size="30" maxlength="25">
                            <f:validateRegex
                                pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                        </p:inputText>
                        <p:message for="email" />

                        <p:selectOneRadio id="sexo" value="#{manejadorCursos.estudiante.sexo}" unselectable="true" required="true" requiredMessage="Seleccione Sexo">
                            <f:selectItem itemLabel="Masculino" itemValue="#{true}" />
                            <f:selectItem itemLabel="Femenino" itemValue="#{false}" />
                        </p:selectOneRadio>
                        <p:message for="sexo" />

                        <h:selectOneMenu id="idDepartamento" value="#{manejadorCursos.idDepartamento}" required="true">
                            <f:selectItem itemLabel="Seleccione Departamento" noSelectionOption="true" itemDisabled="false" />
                            <f:selectItems value="#{manejadorCursos.llenarDepartamentos()}" var="valor" itemValue="#{valor.idDepartamento}" 
                                           itemLabel="#{valor.nombreDepartamento}">
                            </f:selectItems>
                            <p:ajax update="idCarrera"/>
                        </h:selectOneMenu>

                        <h:selectOneMenu id="idCarrera" value="#{manejadorCursos.idCarrera}" required="true" requiredMessage="Seleccione Carrera">
                            <f:selectItem itemLabel="Seleccione Carrera" noSelectionOption="true" itemDisabled="false" />
                            <f:selectItems value="#{manejadorCursos.llenarCarreras()}" var="valor" itemValue="#{valor.idCarrera}" itemLabel="#{valor.nombreCarrera}">
                            </f:selectItems>
                        </h:selectOneMenu>
                        <p:message for="idCarrera" />

                        <p:commandButton value="Inscribir" id="btnInscribir" action="#{manejadorCursos.agregaEstudiante()}"
                                         update="panel, mensaje">
                        </p:commandButton> 


                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>
    </h:body>
</html>

